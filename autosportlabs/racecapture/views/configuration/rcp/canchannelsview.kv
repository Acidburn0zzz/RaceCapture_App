#:kivy 1.9.0
#:import ColorScheme autosportlabs.racecapture.theme.color.ColorScheme

<LargeSpinnerOption>:
    font_size: self.height * 0.5
    
<LargeMappedSpinner>:
    font_size: self.height * 0.5
    option_cls: 'LargeSpinnerOption'

<LargeFloatValueField>:
    font_size: self.height * 0.6

<LargeIntegerValueField>:
    font_size: self.height * 0.6
    
<LargeFieldLabel>:
    font_size: self.height * 0.8
    
<SectionBoxLayout>:
    canvas.before:
        Color:
            rgba: 0.1, 0.1, 0.1, 1
        Rectangle:
            pos: self.pos
            size: self.size             
    padding: (sp(5), sp(5))                    

<CANChannelConfigView>:
    spacing: sp(10)
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint_y: 0.9
            spacing: sp(10)
            orientation: 'vertical'
            
            BoxLayout:
                orientation: 'horizontal'
                BoxLayout:
                    padding: (sp(5), sp(5))
                    size_hint_x: 0.3
                    orientation: 'horizontal'
                    ChannelNameSelectorView:
                        id: chan_id
                        size_hint_x: 0.35
                BoxLayout:
                    spacing: sp(3)
                    size_hint_x: 0.7
                    orientation: 'horizontal'
                    SectionBoxLayout:
                        size_hint_x: 0.6
                        FieldLabel:
                            size_hint_x: 0.2
                            text: 'Sample Rate'
                            halign: 'right'
                        SampleRateSpinner:
                            id: sr
                            size_hint_x: 0.15
                            on_text: root.on_sample_rate(*args)
                    SectionBoxLayout:
                        size_hint_x: 0.4
                        FieldLabel:
                            size_hint_x: 0.2
                            text: 'CAN Bus'
                            halign: 'right'
                        LargeMappedSpinner:
                            size_hint_x: 0.1
                            id: can_bus_channel
                            on_text: root.on_can_bus_channel(*args)
    
            HLineSeparator:
                        
            BoxLayout:
                orientation: 'horizontal'
                spacing: sp(5)
                BoxLayout:
                    size_hint_x: 0.3
                    padding: (0, sp(10))
                    spacing: sp(5)
                    orientation: 'horizontal'
                    FieldLabel:
                        halign: 'right'
                        text: 'CAN ID'
                        size_hint_x: 0.1
                    LargeIntegerValueField:
                        id: can_id
                        size_hint_x: 0.2            
                        on_text: root.on_can_id(*args)
                BoxLayout:
                    size_hint_x: 0.7
                    orientation: 'horizontal'
                    spacing: sp(3)
                    SectionBoxLayout:
                        size_hint_x: 0.6
                        FieldLabel:
                            halign: 'right'
                            text: 'Offset'
                            size_hint_x: 0.1
                        LargeMappedSpinner:
                            id: offset
                            size_hint_x: 0.1
                            on_text: root.on_bit_offset(*args)
                        FieldLabel:
                            halign: 'right'
                            text: 'Length'
                            size_hint_x: 0.1
                        LargeMappedSpinner:
                            id: length
                            size_hint_x: 0.1
                            on_text: root.on_bit_length(*args)
                    SectionBoxLayout:
                        size_hint_x: 0.4                    
                        BoxLayout:
                            orientation: 'vertical'
                            size_hint_x: 0.3
                            spacing: sp(5)
                            BoxLayout:
                                spacing: sp(5)
                                orientation: 'horizontal'
                                FieldLabel:
                                    text: 'Bit Mode'
                                    halign: 'right'
                                CheckBox:
                                    id: bitmode
                                    on_active: root.on_bit_mode(*args)
                            BoxLayout:
                                spacing: sp(5)
                                orientation: 'horizontal'
                                FieldLabel:
                                    text: 'Endian'
                                    halign: 'right'
                                MappedSpinner:
                                    id: endian
                                    on_text: root.on_endian(*args)

            HLineSeparator
                    
            BoxLayout:
                orientation: 'horizontal'
                spacing: sp(5)
                FieldLabel:
                    text: 'Formula'
                    size_hint_x: 0.3
                    halign: 'right'
                SectionBoxLayout:
                    padding: (0, sp(10))
                    orientation: 'horizontal'
                    size_hint_x: 0.7
                    LargeFieldLabel:
                        size_hint_x: 0.3
                        halign: 'right'
                        text: u'(Raw \u00D7 '
                    LargeFloatValueField:
                        id: multiplier
                        size_hint_x: 0.3
                        on_text: root.on_multiplier(*args)
                    LargeFieldLabel:
                        text: ' ) + '
                        halign: 'center'
                        size_hint_x: 0.15
                    LargeFloatValueField:
                        id: adder
                        size_hint_x: 0.25
                        on_text: root.on_adder(*args)
                
            BoxLayout:
                orientation: 'horizontal'
                spacing: sp(5)
                FieldLabel:
                    halign: 'right'
                    size_hint_x: 0.3
                    text: 'Conversion Filter'
                MappedSpinner:
                    id: filters     
                    size_hint_x: 0.7
                    on_text: root.on_filter(*args)
                               
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.1
            IconButton:
                text: u'\uf00c'
                on_press: root.on_commit()
            IconButton:
                text: u'\uf00d'
                on_press: root.on_cancel()

<CANChannelView>:
    spacing: dp(10)
    size_hint_y: None
    height: dp(30)
    orientation: 'horizontal'
    FieldLabel:
        id: channel_name
        size_hint_x: 0.18
    FieldLabel:
        id: can_id
        size_hint_x: 0.17
    FieldLabel:
        id: can_offset_len
        size_hint_x: 0.2
    FieldLabel:
        size_hint_x: 0.25
        id: can_formula
    SampleRateSpinner:
        id: sr
        size_hint_x: 0.15
        on_text: root.on_sample_rate(*args)
    IconButton:
        size_hint_x: 0.05        
        text: u'\uf044'
        on_release: root.on_customize()
    IconButton:
        size_hint_x: 0.05        
    	text: u'\uf014'
    	on_release: root.on_delete()

<CANChannelsView>:
    spacing: dp(20)
    orientation: 'vertical'
    BoxLayout:
        orientation: 'vertical'
        size_hint_y: 0.20
    	SettingsView:
            size_hint_y: 0.6
    		id: can_channels_enable
    		label_text: 'CAN channels'
    		help_text: 'Enable CAN data mappings'
    	BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.4        
            BoxLayout:
                size_hint_x: 0.8
            LabelIconButton:
                size_hint_x: 0.2
                id: load_preset
                title: 'Presets'
                icon_size: self.height * 0.7
                title_font_size: self.height * 0.5
                icon: u'\uf150'
                on_press: root.load_preset_view()
    	
	BoxLayout:
        size_hint_y: 0.70
		#spacing: dp(5)
		orientation: 'vertical'		
	    HSeparator:
	        text: 'CAN Channels'
		BoxLayout:
			orientation: 'horizontal'
			size_hint_y: 0.1
			#spacing: dp(5)
	        FieldLabel:
	            text: 'Channel'
	        	size_hint_x: 0.18
            FieldLabel:
                text: 'ID'
                size_hint_x: 0.17
            FieldLabel:
                text: 'Offset(Length)'
                size_hint_x: 0.2
            FieldLabel:
                text: 'Formula'
                size_hint_x: 0.25
            FieldLabel:
                text: 'Sample Rate'
                size_hint_x: 0.15
            FieldLabel:
                text: ''
                size_hint_x: 0.1
            
        AnchorLayout:	        	
        	AnchorLayout:
        	    ScrollView:
                    canvas.before:
                        Color:
                            rgba: 0.05, 0.05, 0.05, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size        	    
        	        id: scroller
        	        size_hint_y: 0.95
        	        do_scroll_x:False
        	        do_scroll_y:True
        	        GridLayout:
        	            id: can_grid
        	            spacing: [dp(10), dp(10)]
        	            size_hint_y: None
        	            height: max(self.minimum_height, scroller.height)
        	            cols: 1
                FieldLabel:
                    halign: 'center'
                    id: list_msg
                    text: ''
        	            
            AnchorLayout:
                anchor_y: 'bottom'
                IconButton:
                    size_hint: (None, None)
                    height: root.height * .12
                    text: u'\uf055'
                    color: ColorScheme.get_accent()
                    on_release: root.on_add_can_channel()
                    disabled: True
                    id: add_can_channel
    
<PresetItemView>:
    canvas.before:
        Color:
            rgba: 0.01, 0.01, 0.01, 1
        Rectangle:
            pos: self.pos
            size: self.size             

    orientation: 'vertical'
    size_hint_y: None
    height: sp(200)
    padding: (sp(20), sp(0))
    spacing: sp(10)
    FieldLabel:
        id: title
        size_hint_y: 0.1
    BoxLayout:
        spacing: sp(10)
        size_hint_y: 0.85
        orientation: 'horizontal'
        AnchorLayout:
            size_hint_x: 0.75
            Image:
                id: image
            AnchorLayout:
                anchor_y: 'bottom'
                BoxLayout:
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0, 0.7
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    size_hint_y: 0.3
                    FieldLabel:
                        halign: 'left'
                        id: notes

        AnchorLayout:
            size_hint_x: 0.25
            anchor_x: 'center'
            anchor_y: 'center'
            LabelIconButton:
                size_hint_x: 1
                size_hint_y: 0.3
                id: load_preset
                title: 'Select'
                icon_size: self.height * 0.7
                title_font_size: self.height * 0.5
                icon: u'\uf046'
                on_press: root.select_preset()
    
<PresetBrowserView>:
    orientation: 'vertical'
    spacing: sp(10)
    ScrollView:
        size_hint_y: 0.85
        canvas.before:
            Color:
                rgba: 0.05, 0.05, 0.05, 1
            Rectangle:
                pos: self.pos
                size: self.size
        id: scroller
        size_hint_y: 0.95
        do_scroll_x:False
        do_scroll_y:True
        GridLayout:
            id: preset_grid
            spacing: [dp(10), dp(10)]
            size_hint_y: None
            height: max(self.minimum_height, scroller.height)
            cols: 1
    IconButton:
        size_hint_y: 0.15
        text: u'\uf00d'
        on_press: root.on_close()


                    