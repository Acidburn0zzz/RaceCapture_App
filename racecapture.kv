#:kivy 1.0.4


[VSeparator@Widget]:
    size_hint_x: None
    width: 10
    canvas:
        Color:
            rgba: .8, .8, .8, .3
        Rectangle:
            size: 1, self.height
            pos: self.center_x, self.y

[HSeparator@Label]:
    size_hint_y: None
    height: max(dp(40), self.texture_size[1] + dp(10))
    text: ctx.text if 'text' in ctx else ''
    text_size: self.width, None
    valign: 'middle'
    halign: 'center'
    canvas.before:
        Color:
            rgba: .21, .75, .95, .6
        Rectangle:
            size: self.size
            pos: self.pos

[HSeparatorMinor@Label]:
    size_hint_y: None
    height: max(dp(40), self.texture_size[1] + dp(10))
    text: ctx.text if 'text' in ctx else ''
    text_size: self.width, None
    valign: 'middle'
    halign: 'center'
    canvas.before:
        Color:
            rgba: .1, .1, .1, .8
        Rectangle:
            size: self.size
            pos: self.pos

<RaceCaptureApp>:

<ChannelNameSelectorView>:
    BoxLayout:
        padding:[2,2]
        orientation: 'horizontal'
        Label:
            text: 'Channel Name'
        ChannelNameSpinner:

<SampleRateSelectorView>:
    BoxLayout:
        padding:[2,2]
        orientation: 'horizontal'
        Label:
            text: 'Sample Rate'
        SampleRateSpinner:

<SplashView>:
    Label:
        text: 'Welcome to RaceCapture!'

<GPSChannelsView>:
    spacing: 20
    orientation: 'vertical'
    SampleRateSelectorView:
        size_hint: (1.0,0.1)
    GridLayout:
        size_hint: (1.0,0.4)
        cols: 2
        Label:
            text: 'Position'
        CheckBox:
        Label:
            text: 'Speed'
        CheckBox:
        Label:
            text: 'Distance'
        CheckBox:
        Label:
            text: 'Time of Day'
        CheckBox:
        Label:
            text: 'Satellites'
        CheckBox:
    Label:
        size_hint: (1.0, 1.0)

<TargetConfigView>:
    cols: 3
    padding: [10,10]
    spacing: [10,10]
    Label:
        text: 'Target Latitude / Longitude'
    TextInput:
        multiline: False
    TextInput:
        multiline: False
    Label:
        text: 'Target Radius'
    TextInput:
    Label:
        text: 'Degrees'
        halign: 'left'
        text_size: (150, None)
        
<TrackConfigView>:
    orientation:  'vertical'
    HSeparator:
        text: 'Start/Finish Point'
    TargetConfigView:
    HSeparator:
        text: 'Split Point'
    TargetConfigView:
    HSeparator:
        text: 'Channels'
    BoxLayout:
        padding: [5,5]
        orientation: 'vertical'
        GridLayout:
            spacing: [3,3]
            cols: 2
            Label:
                text: 'Current Predicted Time'
            SampleRateSpinner:
            Label:
                text: 'Last Lap Time'
            SampleRateSpinner:
            Label:
                text: 'Split Time'
            SampleRateSpinner:
            Label:
                text: 'Lap Count'
            SampleRateSpinner:
    Label:
        size_hints:(None,0.1)
   
<CANChannelsView>:
    Label:
        text: 'CAN channels'

<OBD2ChannelsView>:
    orientation: 'vertical'
    padding: [2,2]
    HSeparator:
        padding: [10,10]
        text: 'OBD2 Channels'
    ScrollView:
        id: scrlobd2
        do_scroll_x:False
        GridLayout:
            padding: [20,20]
            spacing: [10,10]
            height: max(self.minimum_height, scrlobd2.height)
            cols: 2
            Label:
                text: 'Engine Load'
            SampleRateSpinner:
            Label:
                text: 'Coolant Temperature (C)'
            SampleRateSpinner:
            Label:
                text: 'Fuel Pressure (KPa gauge)'
            SampleRateSpinner:
            Label:
                text: 'Intake Manifold Pressure (KPa absolute)'
            SampleRateSpinner:
            Label:
                text: 'RPM'
            SampleRateSpinner:
            Label:
                text: 'Vehicle Speed (km/h)'
            SampleRateSpinner:
            Label:
                text: 'Ignition Advance (degrees)'
            SampleRateSpinner:
            Label:
                text: 'Intake Air Temperature (C)'
            SampleRateSpinner:
            Label:
                text: 'MAF Airflow Rate (gm / sec)'
            SampleRateSpinner:
            Label:
                text: 'Throttle Position (%)'
            SampleRateSpinner:
            Label:
                text: 'Fuel Level (%)'
            SampleRateSpinner:
            Label:
                text: 'Engine Oil Temp (C)'
            SampleRateSpinner:


<PulseChannelsView>:

<PulseChannel>:
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout: 
            padding: [5, 5]
            orientation: 'vertical'
            HSeparator:
                text: 'Configuration'
            ChannelNameSelectorView:
            SampleRateSelectorView:
            Label:
                size_hint: (None, 1.0)
        BoxLayout:
            padding: [5, 5]
            orientation: 'vertical'
            HSeparator:
                text: 'Options'
            BoxLayout:
                padding: [2, 2]
                orientation: 'horizontal'
                Label:
                    text: 'Channel Operation Mode'
                Spinner:
                    values: ['RPM','Frequency', 'Duration (ms)']
            BoxLayout:
                padding: [2, 2]
                orientation: 'horizontal'
                Label:
                    text: 'Clock Divider'
                Spinner:
                    values: ['Clock/128','Clock/64']
            BoxLayout:
                padding: [2, 2]
                orientation: 'horizontal'
                Label:
                    text: 'Pulse per Revolution/\nTeeth per Wheel'
                Spinner:
                    values: ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32']             

<GPIOChannelsView>:

<GPIOChannel>:
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout: 
            padding: [5, 5]
            size_hint: (1.0,1.0)
            orientation: 'vertical'
            HSeparator:
                text: 'Configuration'
            ChannelNameSelectorView:
            SampleRateSelectorView:
        BoxLayout:
            padding: [5, 5]
            size_hint: (1.0,1.0)
            orientation: 'vertical'
            HSeparator:
                text: 'Options'
            BoxLayout:
                orientation: 'horizontal'
                size_hint: (1.0,0.5)
                Label:
                    text: 'Mode'
                Spinner:
                    values: ['Input','Output']
            Label:
                size_hint: (None, 0.5)

<AccelGyroChannelsView>:
    orientation: 'vertical'
    padding: [5,5]
    SampleRateSelectorView:
        size_hint: (1.0,0.2)
    HSeparator:
        text: 'Accelerometer Channels'
    GridLayout:
        size_hint: (1.0,0.6)
        padding: [5,5]
        spacing: [5,5]
        cols: 5
        HSeparatorMinor:
            text: 'Axis'
        HSeparatorMinor:
            text: 'Enabled'
        HSeparatorMinor:
            text: 'Mode'
        HSeparatorMinor:
            text: 'Hardware Mapping'
        HSeparatorMinor:
            text: 'Zero Level'
        Label:
            text: 'X'   
        CheckBox:
        OrientationSpinner:
        AccelMappingSpinner:
        TextInput:
            text: '2048'

        Label:
            text: 'Y'
        CheckBox:
        OrientationSpinner:
        AccelMappingSpinner:
        TextInput:
            text: '2048'

        Label:
            text: 'Z'
        CheckBox:
        OrientationSpinner:
        AccelMappingSpinner:
        TextInput:
            text: '2048'

    HSeparator:
        text: 'Gyro Channels'
    GridLayout:
        size_hint: (1.0,0.3)
        padding: [5,5]
        spacing: [5,5]
        cols: 5
        HSeparatorMinor:
            text: 'Axis'
        HSeparatorMinor:
            text: 'Enabled'
        HSeparatorMinor:
            text: 'Mode'
        HSeparatorMinor:
            text: 'Hardware Mapping'
        HSeparatorMinor:
            text: 'Zero Level'

        Label:
            text: 'Yaw'
        CheckBox:
        OrientationSpinner:
        GyroMappingSpinner:
        TextInput:
            text: '1862'
    HSeparator:
        text: 'Calibration'
    BoxLayout:
        size_hint: (0.5, 0.2)
        spacing: [10,10]
        padding: [10,10]
        Button:
            text: 'Set Zero Value'

<AnalogPulseOutputChannel>:
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout: 
            padding: [5, 5]
            orientation: 'vertical'
            HSeparator:
                text: 'Configuration'
            ChannelNameSelectorView:
                size_hint:[1.0, 0.25]
            SampleRateSelectorView:
                size_hint:[1.0, 0.25]
            BoxLayout:
                size_hint:[1.0, 0.25]
                orientation: 'horizontal'
                Label:
                    text: 'Logging Scale Factor'
                TextInput:
                    
        BoxLayout:
            padding: [5, 5]
            orientation: 'vertical'
            HSeparator:
                text: 'Startup Options'
            BoxLayout:
                padding: [2, 2]
                orientation: 'horizontal'
                Label:
                    text: 'Duty Cycle (0-100%)'
                TextInput:
            BoxLayout:
                padding: [2, 2]
                orientation: 'horizontal'
                Label:
                    text: 'Period (0-4095)'
                TextInput:
            Label:
                size_hint: (None, 0.5)


<AnalogPulseOutputChannelsView>:

<CellTelemetryView>:
    Label:
        text: 'Cellular telemetry view'

<BluetoothTelemetryView>:
    Label:
        text: 'Bluetooth Telemetry View'

<LuaCodeInput>:

<LuaScriptingView>:
    BoxLayout:
        spacing: [5,5]
        padding: [5,5]
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.9
            ScrollView:
                size_hint_y: 0.75
                do_scroll_x:False
                id: luaScriptScrollView
                LuaCodeInput:
                    size_hint_y: None
                    font_name: 'data/fonts/DroidSansMono.ttf'
                    font_size: 16
                    height: max(self.minimum_height, luaScriptScrollView.height)
            Splitter:
                horizontal: False
                sizable_from: 'top'
                ScrollView:
                    size_hint_y: 0.25
                    id: loggingScrollView
                    do_scroll_x:False
                    TextInput:
                        size_hint_y: None
                        height: max(self.minimum_height, loggingScrollView.height)
        BoxLayout:
            size_hint_y: 0.1
            padding: [10,10]
            orientation: 'horizontal'
            height: 30
            Button:
                size_hint_x: 0.25
                text: "Read"
            Button:
                size_hint_x: 0.25
                text: "Write"
            Button:
                size_hint_x: 0.25
                text: "Run"


<AnalogChannelsView>:

<AnalogScaler>:
    id: graph
    size_hint: (0.75, 1.0)
    xlabel: 'Volts'
    ylabel: 'Scaled'
    x_ticks_minor: 1.25
    x_ticks_major: 25
    y_grid_label: True
    x_grid_label: True
    padding: 5
    x_grid: True
    y_grid: True
    xmin: 0
    xmax: 5
    ymin: -100
    ymax: 100

<AnalogChannel>:
    padding: [5,5]
	orientation: 'horizontal'            
	BoxLayout:
        orientation: 'vertical'
        padding: [0,0,2,0]
        spacing: [2,2]
        HSeparator:
            text: 'Configuration'
        ChannelNameSelectorView:
            size_hint: (1.0,0.3)
        SampleRateSelectorView:
            size_hint: (1.0,0.3)
        HSeparator:
            text: 'Mode'
	    GridLayout:
	        size_hint: (1.0, 1.0)
	        cols: 2
	        Label:
        		text: 'Raw (0 - 1023)'
	        CheckBox:
	        	group: 'scalingType'
	        Label:
	        	text: 'Simple'
	        CheckBox:
	        	group: 'scalingType'
	        Label:
	        	text: 'Mapped'
	        CheckBox:
	        	group: 'scalingType'
    VSeparator:
    BoxLayout:
        orientation: 'vertical'
        padding: [2,0,0,0]
        HSeparator:
            text: 'Calibration'
        AnalogScaler:
            size_hint: (1.0, 0.6)
        GridLayout:
            cols: 6
            size_hint: (1.0, 0.4)
            Label:
                text: ''
            Label:
                text: '1'
            Label:
                text: '2'
            Label:
                text: '3'
            Label:
                text: '4'
            Label:
                text: '5'
            Label:
                text: 'Volts'
            TextInput:
                text: '0.00'
            TextInput:
                text: '1.25'
            TextInput:
                text: '2.50'
            TextInput:
                text: '3.75'
            TextInput:
                text: '5.00'
            Label:
                text: 'Scaled'
            TextInput:
                text: '0.00'
            TextInput:
                text: '1.25'
            TextInput:
                text: '2.50'
            TextInput:
                text: '3.75'
            TextInput:
                text: '5.00'



                
